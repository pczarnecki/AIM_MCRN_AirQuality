require(mgcv)
bologna <- read.csv("bologna_full.csv")
bologna <- na.omit(bologna)
modena <- read.csv("modena_full.csv")
modena <- na.omit(modena)
florence <- read.csv("florence_full.csv")
florence <- na.omit(florence)
rome <- read.csv("rome_full.csv")
rome <- na.omit(rome)
num_iter <- 30
for(i in 0:num_iter) {
num_lag <- i
bologna <- read.csv("bologna_full.csv")
bologna$Daily.1 <- c(bologna$Daily[(1+num_lag):(nrow(bologna))], rep(NA, num_lag))
bologna <- na.omit(bologna)
infections.gam <- gam(Daily.1 ~ s(NPI, k=5), family=poisson(link="log"), data=bologna)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
summary(infections.gam)
print(cat("Day:", i, "R-sq", summary(infections.gam)$r.sq))
}
for(i in 0:num_iter) {
num_lag <- i
modena <- read.csv("modena_full.csv")
modena$Daily.1 <- c(modena$Daily[(1+num_lag):(nrow(modena))], rep(NA, num_lag))
modena <- na.omit(modena)
infections.gam <- gam(Daily.1 ~  s(NPI, k=5), family=poisson(link="log"), data=modena)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
summary(infections.gam)
print(cat("Day:", i, "R-sq", summary(infections.gam)$r.sq))
}
for(i in 0:num_iter) {
num_lag <- i
florence <- read.csv("florence_full.csv")
florence$Daily.1 <- c(florence$Daily[(1+num_lag):(nrow(florence))], rep(NA, num_lag))
florence <- na.omit(florence)
infections.gam <- gam(Daily.1 ~ s(NPI, k=5), family=poisson(link="log"), data=florence)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
summary(infections.gam)
print(cat("Day:", i, "R-sq", summary(infections.gam)$r.sq))
}
for(i in 0:num_iter) {
num_lag <- i
rome <- read.csv("rome_full.csv")
rome$Daily.1 <- c(rome$Daily[(num_lag+1):(nrow(rome))], rep(NA, num_lag))
rome <- na.omit(rome)
infections.gam <- gam(Daily.1 ~  s(NPI), family=poisson(link="log"), data=rome)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
print(cat("Day:", i, "R-sq", summary(infections.gam)$r.sq))
}
for(i in 0:num_iter) {
num_lag <- i
bologna <- read.csv("bologna_full.csv")
bologna$Daily.1 <- c(bologna$Daily[(1+num_lag):(nrow(bologna))], rep(NA, num_lag))
bologna$NPI.1 <- c(rep(NA, 10), bologna$NPI[(1):(nrow(bologna)-10)])
bologna <- na.omit(bologna)
infections.gam <- gam(Daily.1 ~ s(Temperature) + s(Humidity) +s(NPI.1), family=poisson(link="log"), data=bologna)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
summary(infections.gam)
print(cat("Day:", i, "R-sq", summary(infections.gam)$r.sq))
}
for(i in 0:num_iter) {
num_lag <- i
bologna <- read.csv("bologna_full.csv")
bologna$Daily.1 <- c(bologna$Daily[(1+num_lag):(nrow(bologna))], rep(NA, num_lag))
bologna$NPI.1 <- c(rep(NA, 10), bologna$NPI[(1):(nrow(bologna)-10)])
bologna <- na.omit(bologna)
infections.gam <- gam(Daily.1 ~ s(Temperature) + s(Humidity) +s(NPI.1), family=poisson(link="log"), data=bologna)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
summary(infections.gam)
print(cat("Day:", i, "R-sq", summary(infections.gam)$r.sq))
}
for(i in 6:6) {
num_lag <- i
bologna <- read.csv("bologna_full.csv")
bologna$Daily.1 <- c(bologna$Daily[(1+num_lag):(nrow(bologna))], rep(NA, num_lag))
bologna <- na.omit(bologna)
infections.gam <- gam(Daily.1 ~ s(NPI, k=5), family=poisson(link="log"), data=bologna)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
summary(infections.gam)
print(cat("Day:", i, "R-sq", summary(infections.gam)$r.sq))
}
gam.check(infections.gam)
summary(infections.gam)
for(i in 0:num_iter) {
num_lag <- i
florence <- read.csv("florence_full.csv")
florence$Daily.1 <- c(florence$Daily[(1+num_lag):(nrow(florence))], rep(NA, num_lag))
florence <- na.omit(florence)
infections.gam <- gam(Daily.1 ~ s(Temperature) + s(Humidity), family=poisson(link="log"), data=florence)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
summary(infections.gam)
print(cat("Day:", i, "R-sq", AIC(infections.gam))
}
for(i in 0:num_iter) {
num_lag <- i
florence <- read.csv("florence_full.csv")
florence$Daily.1 <- c(florence$Daily[(1+num_lag):(nrow(florence))], rep(NA, num_lag))
florence <- na.omit(florence)
infections.gam <- gam(Daily.1 ~ s(Temperature) + s(Humidity), family=poisson(link="log"), data=florence)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
summary(infections.gam)
print(cat("Day:", i, "R-sq", AIC(infections.gam)))
}
for(i in 0:num_iter) {
num_lag <- i
bologna <- read.csv("bologna_full.csv")
bologna$Daily.1 <- c(bologna$Daily[(1+num_lag):(nrow(bologna))], rep(NA, num_lag))
bologna$NPI.1 <- c(rep(NA, 10), bologna$NPI[(1):(nrow(bologna)-10)])
bologna <- na.omit(bologna)
infections.gam <- gam(Daily.1 ~ s(Temperature) + s(Humidity) +s(NPI.1), family=poisson(link="log"), data=bologna)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
summary(infections.gam)
print(cat("Day:", i, "R-sq", summary(infections.gam)$r.sq))
}
for(i in 0:num_iter) {
num_lag <- i
bologna <- read.csv("bologna_full.csv")
bologna$Daily.1 <- c(bologna$Daily[(1+num_lag):(nrow(bologna))], rep(NA, num_lag))
bologna$npi.1 <- as.factor(c(rep(NA, 10), bologna$npi[(1):(nrow(bologna)-10)]))
bologna <- na.omit(bologna)
infections.gam <- gam(Daily.1 ~ s(Temperature) + s(Humidity) +s(npi.1), family=poisson(link="log"), data=bologna)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
summary(infections.gam)
print(cat("Day:", i, "R-sq", summary(infections.gam)$r.sq))
}
for(i in 0:num_iter) {
num_lag <- i
bologna <- read.csv("bologna_full.csv")
bologna$Daily.1 <- c(bologna$Daily[(1+num_lag):(nrow(bologna))], rep(NA, num_lag))
bologna$npi.1 <- c(rep(NA, 10), bologna$npi[(1):(nrow(bologna)-10)])
bologna <- na.omit(bologna)
infections.gam <- gam(Daily.1 ~ s(Temperature) + s(Humidity) +s(npi.1, k=4), family=poisson(link="log"), data=bologna)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
summary(infections.gam)
print(cat("Day:", i, "R-sq", summary(infections.gam)$r.sq))
}
for(i in 0:num_iter) {
num_lag <- i
bologna <- read.csv("bologna_full.csv")
bologna$Daily.1 <- c(bologna$Daily[(1+num_lag):(nrow(bologna))], rep(NA, num_lag))
#bologna$npi.1 <- c(rep(NA, 10), bologna$npi[(1):(nrow(bologna)-10)])
bologna <- na.omit(bologna)
infections.gam <- gam(Daily.1 ~ s(Temperature) + s(Humidity) +s(npi.1, k=4), family=poisson(link="log"), data=bologna)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
summary(infections.gam)
print(cat("Day:", i, "R-sq", summary(infections.gam)$r.sq))
}
for(i in 0:num_iter) {
num_lag <- i
bologna <- read.csv("bologna_full.csv")
bologna$Daily.1 <- c(bologna$Daily[(1+num_lag):(nrow(bologna))], rep(NA, num_lag))
#bologna$npi.1 <- c(rep(NA, 10), bologna$npi[(1):(nrow(bologna)-10)])
bologna <- na.omit(bologna)
infections.gam <- gam(Daily.1 ~ s(Temperature) + s(Humidity) +s(npi, k=4), family=poisson(link="log"), data=bologna)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
summary(infections.gam)
print(cat("Day:", i, "R-sq", summary(infections.gam)$r.sq))
}
for(i in 0:num_iter) {
num_lag <- i
bologna <- read.csv("bologna_full.csv")
bologna$Temperature.1 <- c(rep(NA, 4),  bologna$Temperature[(1):(nrow(bologna)-4)])
bologna$Humidity.1 <- c(rep(NA, 4), bologna$Humidity[(1):(nrow(bologna)-4)])
bologna$npi.1 <- c(rep(NA, num_lag), bologna$npi[(1):(nrow(bologna)-num_lag)])
bologna <- na.omit(bologna)
infections.gam <- gam(Daily.1 ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4), family=poisson(link="log"), data=bologna)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
summary(infections.gam)
print(cat("Day:", i, "R-sq", summary(infections.gam)$r.sq))
}
for(i in 0:num_iter) {
num_lag <- i
bologna <- read.csv("bologna_full.csv")
bologna$Temperature.1 <- c(rep(NA, 4),  bologna$Temperature[(1):(nrow(bologna)-4)])
bologna$Humidity.1 <- c(rep(NA, 4), bologna$Humidity[(1):(nrow(bologna)-4)])
bologna$npi.1 <- c(rep(NA, num_lag), bologna$npi[(1):(nrow(bologna)-num_lag)])
bologna <- na.omit(bologna)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4), family=poisson(link="log"), data=bologna)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
summary(infections.gam)
print(cat("Day:", i, "R-sq", summary(infections.gam)$r.sq))
}
for(i in 0:num_iter) {
num_lag <- i
bologna <- read.csv("bologna_full.csv")
bologna$Temperature.1 <- c(rep(NA, 3),  bologna$Temperature[(1):(nrow(bologna)-3)])
bologna$Humidity.1 <- c(rep(NA, 3), bologna$Humidity[(1):(nrow(bologna)-3)])
bologna$npi.1 <- c(rep(NA, num_lag), bologna$npi[(1):(nrow(bologna)-num_lag)])
bologna <- na.omit(bologna)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4), family=poisson(link="log"), data=bologna)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
summary(infections.gam)
print(cat("Day:", i, "R-sq", summary(infections.gam)$r.sq))
}
for(i in 0:num_iter) {
num_lag <- i
bologna <- read.csv("bologna_full.csv")
bologna$Temperature.1 <- c(rep(NA, 5),  bologna$Temperature[(1):(nrow(bologna)-5)])
bologna$Humidity.1 <- c(rep(NA, 5), bologna$Humidity[(1):(nrow(bologna)-5)])
bologna$npi.1 <- c(rep(NA, num_lag), bologna$npi[(1):(nrow(bologna)-num_lag)])
bologna <- na.omit(bologna)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4), family=poisson(link="log"), data=bologna)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
summary(infections.gam)
print(cat("Day:", i, "R-sq", summary(infections.gam)$r.sq))
}
library(mgcv)
library(nlme)
turin <- read.csv("turin_full.csv")
turin <- na.omit(turin)
milan <- read.csv("milan_full.csv")
milan <- na.omit(milan)
brescia <- read.csv("brescia_full.csv")
brescia <- na.omit(brescia)
parma <- read.csv("parma_full.csv")
parma <- na.omit(parma)
num_lag <- 21
climate_lag <- 4
milan <- read.csv("milan_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
milan$Temperature.1 <- c(rep(NA, climate_lag),  milan$Temperature[(1):(nrow(milan)-climate_lag)])
milan$Humidity.1 <- c(rep(NA, climate_lag), milan$Humidity[(1):(nrow(milan)-climate_lag)])
milan$pm25.1 <- c(rep(NA, climate_lag), milan$pm25[(1):(nrow(milan)-climate_lag)])
milan$no2.1 <- c(rep(NA, climate_lag), milan$no2[(1):(nrow(milan)-climate_lag)])
#push npi back num_lag days
milan$npi.1 <- c(rep(NA, num_lag), milan$npi[(1):(nrow(milan)-num_lag)])
#Omit the new NAs
milan <- na.omit(milan)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4) + s(pm25.1) + s(no2.1), family=poisson(link="log"), data=milan)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
brescia <- read.csv("brescia_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
brescia$Temperature.1 <- c(rep(NA, climate_lag),  brescia$Temperature[(1):(nrow(brescia)-climate_lag)])
brescia$Humidity.1 <- c(rep(NA, climate_lag), brescia$Humidity[(1):(nrow(brescia)-climate_lag)])
brescia$pm25.1 <- c(rep(NA, climate_lag), brescia$pm25[(1):(nrow(brescia)-climate_lag)])
brescia$no2.1 <- c(rep(NA, climate_lag), brescia$no2[(1):(nrow(brescia)-climate_lag)])
#push npi back num_lag days
brescia$npi.1 <- c(rep(NA, num_lag), brescia$npi[(1):(nrow(brescia)-num_lag)])
#Omit the new NAs
brescia <- na.omit(brescia)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4) + s(pm25.1) + s(no2.1), family=poisson(link="log"), data=brescia)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
parma <- read.csv("parma_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
parma$Temperature.1 <- c(rep(NA, climate_lag),  parma$Temperature[(1):(nrow(parma)-climate_lag)])
parma$Humidity.1 <- c(rep(NA, climate_lag), parma$Humidity[(1):(nrow(parma)-climate_lag)])
parma$pm25.1 <- c(rep(NA, climate_lag), parma$pm25[(1):(nrow(parma)-climate_lag)])
parma$no2.1 <- c(rep(NA, climate_lag), parma$no2[(1):(nrow(parma)-climate_lag)])
#push npi back num_lag days
parma$npi.1 <- c(rep(NA, num_lag), parma$npi[(1):(nrow(parma)-num_lag)])
#Omit the new NAs
parma <- na.omit(parma)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4) + s(pm25.1) + s(no2.1), family=poisson(link="log"), data=parma)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
for(i in 0:num_iter) {
num_lag <- i
bologna <- read.csv("bologna_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
bologna$Temperature.1 <- c(rep(NA, climate_lag),  bologna$Temperature[(1):(nrow(bologna)-climate_lag)])
bologna$Humidity.1 <- c(rep(NA, climate_lag), bologna$Humidity[(1):(nrow(bologna)-climate_lag)])
#push npi back num_lag days
bologna$npi.1 <- c(rep(NA, num_lag), bologna$npi[(1):(nrow(bologna)-num_lag)])
#Omit the new NAs
bologna <- na.omit(bologna)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4), family=poisson(link="log"), data=bologna)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
}
library(mgcv)
library(nlme)
turin <- read.csv("turin_full.csv")
turin <- na.omit(turin)
milan <- read.csv("milan_full.csv")
milan <- na.omit(milan)
brescia <- read.csv("brescia_full.csv")
brescia <- na.omit(brescia)
parma <- read.csv("parma_full.csv")
parma <- na.omit(parma)
num_lag <- 21
climate_lag <- 4
milan <- read.csv("milan_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
milan$Temperature.1 <- c(rep(NA, climate_lag),  milan$Temperature[(1):(nrow(milan)-climate_lag)])
milan$Humidity.1 <- c(rep(NA, climate_lag), milan$Humidity[(1):(nrow(milan)-climate_lag)])
milan$pm25.1 <- c(rep(NA, climate_lag), milan$pm25[(1):(nrow(milan)-climate_lag)])
milan$no2.1 <- c(rep(NA, climate_lag), milan$no2[(1):(nrow(milan)-climate_lag)])
#push npi back num_lag days
milan$npi.1 <- c(rep(NA, num_lag), milan$npi[(1):(nrow(milan)-num_lag)])
#Omit the new NAs
milan <- na.omit(milan)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4) + s(pm25.1) + s(no2.1), family=poisson(link="log"), data=milan)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
brescia <- read.csv("brescia_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
brescia$Temperature.1 <- c(rep(NA, climate_lag),  brescia$Temperature[(1):(nrow(brescia)-climate_lag)])
brescia$Humidity.1 <- c(rep(NA, climate_lag), brescia$Humidity[(1):(nrow(brescia)-climate_lag)])
brescia$pm25.1 <- c(rep(NA, climate_lag), brescia$pm25[(1):(nrow(brescia)-climate_lag)])
brescia$no2.1 <- c(rep(NA, climate_lag), brescia$no2[(1):(nrow(brescia)-climate_lag)])
#push npi back num_lag days
brescia$npi.1 <- c(rep(NA, num_lag), brescia$npi[(1):(nrow(brescia)-num_lag)])
#Omit the new NAs
brescia <- na.omit(brescia)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4) + s(pm25.1) + s(no2.1), family=poisson(link="log"), data=brescia)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
parma <- read.csv("parma_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
parma$Temperature.1 <- c(rep(NA, climate_lag),  parma$Temperature[(1):(nrow(parma)-climate_lag)])
parma$Humidity.1 <- c(rep(NA, climate_lag), parma$Humidity[(1):(nrow(parma)-climate_lag)])
parma$pm25.1 <- c(rep(NA, climate_lag), parma$pm25[(1):(nrow(parma)-climate_lag)])
parma$no2.1 <- c(rep(NA, climate_lag), parma$no2[(1):(nrow(parma)-climate_lag)])
#push npi back num_lag days
parma$npi.1 <- c(rep(NA, num_lag), parma$npi[(1):(nrow(parma)-num_lag)])
#Omit the new NAs
parma <- na.omit(parma)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4) + s(pm25.1) + s(no2.1), family=poisson(link="log"), data=parma)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
for(i in num_lag:num_lag) {
num_lag <- i
bologna <- read.csv("bologna_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
bologna$Temperature.1 <- c(rep(NA, climate_lag),  bologna$Temperature[(1):(nrow(bologna)-climate_lag)])
bologna$Humidity.1 <- c(rep(NA, climate_lag), bologna$Humidity[(1):(nrow(bologna)-climate_lag)])
#push npi back num_lag days
bologna$npi.1 <- c(rep(NA, num_lag), bologna$npi[(1):(nrow(bologna)-num_lag)])
#Omit the new NAs
bologna <- na.omit(bologna)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4), family=poisson(link="log"), data=bologna)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
}
for(i in num_lag:num_lag) {
num_lag <- i
modena <- read.csv("modena_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
modena$Temperature.1 <- c(rep(NA, climate_lag),  modena$Temperature[(1):(nrow(modena)-climate_lag)])
modena$Humidity.1 <- c(rep(NA, climate_lag), modena$Humidity[(1):(nrow(modena)-climate_lag)])
#push npi back num_lag days
modena$npi.1 <- c(rep(NA, num_lag), modena$npi[(1):(nrow(modena)-num_lag)])
#Omit the new NAs
modena <- na.omit(modena)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4), family=poisson(link="log"), data=modena)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
}
for(i in num_lag:num_lag) {
num_lag <- i
florence <- read.csv("florence_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
florence$Temperature.1 <- c(rep(NA, climate_lag),  florence$Temperature[(1):(nrow(florence)-climate_lag)])
florence$Humidity.1 <- c(rep(NA, climate_lag), florence$Humidity[(1):(nrow(florence)-climate_lag)])
#push npi back num_lag days
florence$npi.1 <- c(rep(NA, num_lag), florence$npi[(1):(nrow(florence)-num_lag)])
#Omit the new NAs
florence <- na.omit(florence)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4), family=poisson(link="log"), data=florence)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
}
for(i in num_lag:num_lag) {
num_lag <- i
rome <- read.csv("rome_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
rome$Temperature.1 <- c(rep(NA, climate_lag),  rome$Temperature[(1):(nrow(rome)-climate_lag)])
rome$Humidity.1 <- c(rep(NA, climate_lag), rome$Humidity[(1):(nrow(rome)-climate_lag)])
#push npi back num_lag days
rome$npi.1 <- c(rep(NA, num_lag), rome$npi[(1):(nrow(rome)-num_lag)])
#Omit the new NAs
rome <- na.omit(rome)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4), family=poisson(link="log"), data=rome)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
}
library(mgcv)
library(nlme)
turin <- read.csv("turin_full.csv")
turin <- na.omit(turin)
milan <- read.csv("milan_full.csv")
milan <- na.omit(milan)
brescia <- read.csv("brescia_full.csv")
brescia <- na.omit(brescia)
parma <- read.csv("parma_full.csv")
parma <- na.omit(parma)
num_lag <- 21
climate_lag <- 4
milan <- read.csv("milan_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
milan$Temperature.1 <- c(rep(NA, climate_lag),  milan$Temperature[(1):(nrow(milan)-climate_lag)])
milan$Humidity.1 <- c(rep(NA, climate_lag), milan$Humidity[(1):(nrow(milan)-climate_lag)])
milan$pm25.1 <- c(rep(NA, climate_lag), milan$pm25[(1):(nrow(milan)-climate_lag)])
milan$no2.1 <- c(rep(NA, climate_lag), milan$no2[(1):(nrow(milan)-climate_lag)])
#push npi back num_lag days
milan$npi.1 <- c(rep(NA, num_lag), milan$npi[(1):(nrow(milan)-num_lag)])
#Omit the new NAs
milan <- na.omit(milan)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4), family=poisson(link="log"), data=milan)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
brescia <- read.csv("brescia_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
brescia$Temperature.1 <- c(rep(NA, climate_lag),  brescia$Temperature[(1):(nrow(brescia)-climate_lag)])
brescia$Humidity.1 <- c(rep(NA, climate_lag), brescia$Humidity[(1):(nrow(brescia)-climate_lag)])
brescia$pm25.1 <- c(rep(NA, climate_lag), brescia$pm25[(1):(nrow(brescia)-climate_lag)])
brescia$no2.1 <- c(rep(NA, climate_lag), brescia$no2[(1):(nrow(brescia)-climate_lag)])
#push npi back num_lag days
brescia$npi.1 <- c(rep(NA, num_lag), brescia$npi[(1):(nrow(brescia)-num_lag)])
#Omit the new NAs
brescia <- na.omit(brescia)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4), family=poisson(link="log"), data=brescia)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
parma <- read.csv("parma_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
parma$Temperature.1 <- c(rep(NA, climate_lag),  parma$Temperature[(1):(nrow(parma)-climate_lag)])
parma$Humidity.1 <- c(rep(NA, climate_lag), parma$Humidity[(1):(nrow(parma)-climate_lag)])
parma$pm25.1 <- c(rep(NA, climate_lag), parma$pm25[(1):(nrow(parma)-climate_lag)])
parma$no2.1 <- c(rep(NA, climate_lag), parma$no2[(1):(nrow(parma)-climate_lag)])
#push npi back num_lag days
parma$npi.1 <- c(rep(NA, num_lag), parma$npi[(1):(nrow(parma)-num_lag)])
#Omit the new NAs
parma <- na.omit(parma)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4) , family=poisson(link="log"), data=parma)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
for(i in num_lag:num_lag) {
num_lag <- i
bologna <- read.csv("bologna_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
bologna$Temperature.1 <- c(rep(NA, climate_lag),  bologna$Temperature[(1):(nrow(bologna)-climate_lag)])
bologna$Humidity.1 <- c(rep(NA, climate_lag), bologna$Humidity[(1):(nrow(bologna)-climate_lag)])
#push npi back num_lag days
bologna$npi.1 <- c(rep(NA, num_lag), bologna$npi[(1):(nrow(bologna)-num_lag)])
#Omit the new NAs
bologna <- na.omit(bologna)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4), family=poisson(link="log"), data=bologna)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
}
for(i in num_lag:num_lag) {
num_lag <- i
modena <- read.csv("modena_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
modena$Temperature.1 <- c(rep(NA, climate_lag),  modena$Temperature[(1):(nrow(modena)-climate_lag)])
modena$Humidity.1 <- c(rep(NA, climate_lag), modena$Humidity[(1):(nrow(modena)-climate_lag)])
#push npi back num_lag days
modena$npi.1 <- c(rep(NA, num_lag), modena$npi[(1):(nrow(modena)-num_lag)])
#Omit the new NAs
modena <- na.omit(modena)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4), family=poisson(link="log"), data=modena)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
}
for(i in num_lag:num_lag) {
num_lag <- i
florence <- read.csv("florence_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
florence$Temperature.1 <- c(rep(NA, climate_lag),  florence$Temperature[(1):(nrow(florence)-climate_lag)])
florence$Humidity.1 <- c(rep(NA, climate_lag), florence$Humidity[(1):(nrow(florence)-climate_lag)])
#push npi back num_lag days
florence$npi.1 <- c(rep(NA, num_lag), florence$npi[(1):(nrow(florence)-num_lag)])
#Omit the new NAs
florence <- na.omit(florence)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4), family=poisson(link="log"), data=florence)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
}
for(i in num_lag:num_lag) {
num_lag <- i
rome <- read.csv("rome_full.csv") #Read in file
#Push temperature&humidity data back climate_lag days by adding empty data in front
#rep(NA, n) creates a vector of length n filled with NA
rome$Temperature.1 <- c(rep(NA, climate_lag),  rome$Temperature[(1):(nrow(rome)-climate_lag)])
rome$Humidity.1 <- c(rep(NA, climate_lag), rome$Humidity[(1):(nrow(rome)-climate_lag)])
#push npi back num_lag days
rome$npi.1 <- c(rep(NA, num_lag), rome$npi[(1):(nrow(rome)-num_lag)])
#Omit the new NAs
rome <- na.omit(rome)
infections.gam <- gam(Daily ~ s(Temperature.1) + s(Humidity.1) +s(npi.1, k=4), family=poisson(link="log"), data=rome)
plot(infections.gam,scale=0,se=2, shade=TRUE,pages=1)
title(main = i)
}
